
hostname {{ item.hostname }}
{% if item.ip_routing is defined and item.ip_routing == 'yes' %}
ip routing
{% else %}
{% endif %}
{% if item.ip_ospf_area is defined and item.ip_ospf_area | length > 0 %}
interface loopback 0
ip add 1.1.1.1
router ospf
area {{ item.ip_ospf_area }}
enable
interface loopback 0
no ip add
exit
{% else %}
{% endif %}
{% for item in csvfile.split("\n") %}
{% if loop.index != 1 %}
{% set list = item.split("$") %}
vlan {{ list[1]|trim() }}
name "{{ list[0]|trim() }}"
{% if list[2] != "N/A" %}
ip address {{ list[2]|trim() }}
{% endif %}
{% if list[3] != "N/A" %}
{% set list_helper = list[3].split(",") %}
{% for each_list_helper in list_helper %}
ip helper-address {{ each_list_helper|trim() }}
{% endfor %}
{% else %}
{% endif %}
{% if list[4] == "yes" %}
ip igmp
{% else %}
{% endif %}
ip ospf area {{ list[5]|trim() }}
{% endif %}
{% endfor %}
exit
{% if item.spanning_tree_mode is defined and item.spanning_tree_mode == "rapid" %}
spanning-tree
spanning-tree mode rapid-pvst
y
{% elif item.spanning_tree_mode is defined and item.spanning_tree_mode == "mst" %}
spanning-tree
spanning-tree mode mst
{% elif item.spanning_tree_mode is defined and item.spanning_tree_mode == "pvst" %}
spanning-tree
spanning-tree mode pvst
{% else %}
{% endif %}
{% if item.spanning_tree_vlan is defined and item.spanning_tree_vlan_priority is defined and item.spanning_tree_vlan | length > 0 and item.spanning_tree_vlan_priority | length > 0 %}
spanning-tree vlan {{ item.spanning_tree_vlan }} priority {{ item.spanning_tree_vlan_priority }}
{% else %}
{% endif %}
{% if item.spanning_tree_bpdu_protection_port is defined and item.spanning_tree_bpdu_protection_port | length > 0 %}
spanning-tree {{ item.spanning_tree_bpdu_protection_port }} bpdu-protection
{% else %}
{% endif %}
{% if item.spanning_tree_bpdu_protection_timeout is defined and item.spanning_tree_bpdu_protection_timeout | length > 0 %}
spanning-tree bpdu-protection-timeout {{ item.spanning_tree_bpdu_protection_timeout }}
{% else %}
{% endif %}
{% if item.spanning_tree_loop_protect_port is defined and item.spanning_tree_loop_protect_port | length > 0 %}
loop-protect {{ item.spanning_tree_loop_protect_port }}
{% else %}
{% endif %}
{% if item.spanning_tree_loop_protect_disable_timer is defined and item.spanning_tree_loop_protect_disable_timer | length > 0 %}
loop-protect disable-timer {{ item.spanning_tree_loop_protect_disable_timer }}
{% else %}
{% endif %}
{% if item.snmp_community_operator is defined and item.snmp_community_operator | length > 0  %}
snmp-server community {{ item.snmp_community_operator }} operator
{% endif %}
{% if item.snmp_community_unrestricted is defined and item.snmp_community_unrestricted | length > 0  %}
snmp-server community {{ item.snmp_community_unrestricted }} unrestricted
{% else %}
{% endif %}
{% if item.snmp_contact is defined and item.snmp_contact | length > 0 %}
snmp-server contact "{{ item.snmp_contact }}"
{% else %}
{% endif %}
{% if item.snmp_location is defined and item.snmp_location | length > 0 %}
snmp-server location "{{ item.snmp_location }}"
{% else %}
{% endif %}
{% if item.ntp_server is defined %}
ntp unicast
ntp enable
timesync ntp
{% set ntp_server = item.ntp_server.split(',') %}
{% for each_ntp_server in ntp_server %}
ntp server {{ each_ntp_server }}
{% endfor %}
{% else %}
{% endif %}
{% if item.timezone is defined and item.timezone | length > 0 %}
time daylight-time-rule continental-us-and-canada
time timezone {{ item.timezone }}
{% else %}
{% endif %}
{% if item.dns_suffix is defined and item.dns_suffix | length > 0 %}
ip dns domain-name {{ item.dns_suffix}}
{% else %}
{% endif %}
{% if item.ssh_key_bitsize is defined and item.ssh_key_bitsize | length > 0 %}
crypto key generate ssh rsa bits {{ item.ssh_key_bitsize}}
ip ssh
{% else %}
{% endif %}
{% if item.web_management_ssl is defined and item.web_management_ssl == 'yes' %}
web-management ssl
{% else %}
{% endif %}
{% if item.http_server is defined and item.http_server == 'no' %}
no ip http-server
{% else %}
{% endif %}
banner motd "WARNING
WARNING! WARNING! WARNING! WARNING! WARNING! WARNING!
 WARNING! WARNING!\nWARNING! WARNING! WARNING! WARNING! WARNING! WARNING!
 WARNING! WARNING! WARNING!\n\n \n\n          You have reached a New Mexico
 State Government owned node.\n\n \n\n1) Unauthorized access, unauthorized
 attempts to access, and attempts to disrupt\n   any or all of this nodes
 services is prohibited.\n\n \n\n2) Unauthorized is defined as not being given
 explicit permission in writing by\n   an authoritative administrator of this
 node.\n   P.O.C.: Steve Van Duyn\n   Phone: (575) 812-6030\n\n \n\n3) Any and
 all violators of this directive will be prosecuted to the furthest ex\ntent of
 all applicable rules and/or public laws!\n\n \n\nWARNING! WARNING! WARNING!
 WARNING! WARNING! WARNING! WARNING! WARNING! WARNING!\nWARNING! WARNING!
 WARNING! WARNING! WARNING! WARNING! WARNING! WARNING! WARNING!\n"
